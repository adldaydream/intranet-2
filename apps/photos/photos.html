<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Daydream Adelaide – Photo Gallery</title>
  <link rel="stylesheet" href="photos.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"/>
  <script src="https://cdn.auth0.com/js/auth0-spa-js/2.1/auth0-spa-js.production.js"></script>
</head>
<body>
  <div id="app">
    <div id="auth-buttons" style="text-align:center;margin:20px;">
      <button id="login" style="display:none;">Log In</button>
      <button id="logout" style="display:none;">Log Out</button>
    </div>

    <div id="content" style="display:none;">
      <h1>Daydream Adelaide – Photo Gallery</h1>
      <div class="widget" style="max-width:900px;margin:32px auto;">
        <h2>Event Photos</h2>
        <div id="gallery"></div>
      </div>
    </div>
  </div>

  <script src="photos.js"></script>
  <script>
    // Replace with your own Auth0 settings
    const auth0Config = {
      domain: "dev-qxvhn43m2usqyu2p.au.auth0.com",       // e.g. dev-abc123.us.auth0.com
      clientId: "qc2goou7XOzIkdZArnOJYlVUCcvCzhdO",  // from your Auth0 app
      authorizationParams: {
        redirect_uri: window.location.origin
      }
    };

    let auth0Client;

    async function initAuth() {
      auth0Client = await createAuth0Client(auth0Config);

      // Handle the redirect from Auth0 login
      if (window.location.search.includes("code=") && window.location.search.includes("state=")) {
        await auth0Client.handleRedirectCallback();
        window.history.replaceState({}, document.title, "/");
      }

      const isAuthenticated = await auth0Client.isAuthenticated();

      if (isAuthenticated) {
        document.getElementById("login").style.display = "none";
        document.getElementById("logout").style.display = "inline-block";
        document.getElementById("content").style.display = "block";
      } else {
        document.getElementById("login").style.display = "inline-block";
        document.getElementById("logout").style.display = "none";
        document.getElementById("content").style.display = "none";
      }

      document.getElementById("login").addEventListener("click", () => {
        auth0Client.loginWithRedirect();
      });

      document.getElementById("logout").addEventListener("click", () => {
        auth0Client.logout({ returnTo: window.location.origin });
      });
    }

    initAuth();
  </script>
</body>
</html>
